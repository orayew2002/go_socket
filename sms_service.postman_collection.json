{
  "info": {
    "_postman_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "name": "SMS Service API",
    "description": "API collection for the Go SMS/OTP service.\n\nSet the `base_url` variable to your server address before running requests.\n\nDefault: `http://localhost:5051`",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5051",
      "type": "string",
      "description": "Base URL of the SMS service. Change to your server IP/domain."
    },
    {
      "key": "phone",
      "value": "61123456",
      "type": "string",
      "description": "8-digit Turkmenistan phone number (without +993 prefix). Must match ^[6][1-5][0-9]{6}$"
    }
  ],
  "item": [
    {
      "name": "OTP",
      "description": "Endpoints related to OTP generation and verification.",
      "item": [
        {
          "name": "Send OTP",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone\": \"{{phone}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/otp",
              "host": ["{{base_url}}"],
              "path": ["otp"]
            },
            "description": "Generates a 5-digit OTP, stores it in Redis for 30 minutes (key: `otp:{phone}`), and emits an `otp` Socket.IO event to all connected clients.\n\n**Phone validation:** `^[6][1-5][0-9]{6}$`\n\n**Duplicate guard:** If an OTP already exists for this phone, returns `success: false` asking the caller to wait.\n\n**Socket.IO event emitted:**\n```json\n{ \"phone\": \"+993XXXXXXXX\", \"pass\": \"Siziň aktiwasiýa koduňyz XXXXX\" }\n```"
          },
          "response": [
            {
              "name": "200 – OTP sent successfully",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"61123456\"\n}"
                },
                "url": { "raw": "{{base_url}}/otp" }
              }
            },
            {
              "name": "200 – OTP already exists, wait",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"message\": \"OTP already sent. Please wait.\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"61123456\"\n}"
                },
                "url": { "raw": "{{base_url}}/otp" }
              }
            },
            {
              "name": "400 – Invalid phone number",
              "status": "Bad Request",
              "code": 400,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"message\": \"Bad request\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"99999999\"\n}"
                },
                "url": { "raw": "{{base_url}}/otp" }
              }
            }
          ]
        },
        {
          "name": "Verify OTP",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone\": \"{{phone}}\",\n  \"pass\": \"12345\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/compare",
              "host": ["{{base_url}}"],
              "path": ["compare"]
            },
            "description": "Compares the submitted OTP against the value stored in Redis (`otp:{phone}`).\n\n- If match → deletes the Redis key and returns `success: true`\n- If code is wrong → returns `success: false, message: \"Invalid OTP\"`\n- If key is missing/expired → returns `success: false, message: \"OTP expired\"`"
          },
          "response": [
            {
              "name": "200 – OTP matched",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"61123456\",\n  \"pass\": \"54321\"\n}"
                },
                "url": { "raw": "{{base_url}}/compare" }
              }
            },
            {
              "name": "200 – Wrong OTP",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"message\": \"Invalid OTP\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"61123456\",\n  \"pass\": \"00000\"\n}"
                },
                "url": { "raw": "{{base_url}}/compare" }
              }
            },
            {
              "name": "200 – OTP expired",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": false,\n  \"message\": \"OTP expired\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"61123456\",\n  \"pass\": \"12345\"\n}"
                },
                "url": { "raw": "{{base_url}}/compare" }
              }
            }
          ]
        }
      ]
    },
    {
      "name": "SMS",
      "description": "Endpoints for sending custom SMS messages via Socket.IO.",
      "item": [
        {
          "name": "Send Group SMS",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone\": \"{{phone}}\",\n  \"message\": \"Your custom message here\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/group_sms",
              "host": ["{{base_url}}"],
              "path": ["group_sms"]
            },
            "description": "Emits a custom `otp` Socket.IO event with a user-defined message to all connected clients. No Redis is involved.\n\n**Phone validation:** `^[6][1-5][0-9]{6}$`\n\n**Socket.IO event emitted:**\n```json\n{ \"phone\": \"+993XXXXXXXX\", \"pass\": \"<message>\" }\n```"
          },
          "response": [
            {
              "name": "200 – SMS sent",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"message\": \"Group SMS sent successfully\",\n  \"phone\": \"+99361123456\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"61123456\",\n  \"message\": \"Hello from group!\"\n}"
                },
                "url": { "raw": "{{base_url}}/group_sms" }
              }
            },
            {
              "name": "400 – Invalid phone",
              "status": "Bad Request",
              "code": 400,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"message\": \"Bad request: Invalid phone number\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"12345678\",\n  \"message\": \"test\"\n}"
                },
                "url": { "raw": "{{base_url}}/group_sms" }
              }
            }
          ]
        },
        {
          "name": "Send SMS",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone\": \"+99361123456\",\n  \"message\": \"Your custom message here\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/send-sms",
              "host": ["{{base_url}}"],
              "path": ["send-sms"]
            },
            "description": "Sends a custom SMS message to a single phone number. Accepts phone numbers **with or without** the `+993` country code prefix.\n\n**Phone validation:** `^(\\+993)?6[1-5]\\d{6}`\n\nExamples of valid phones:\n- `61123456`\n- `+99361123456`\n\n**Socket.IO event emitted:**\n```json\n{ \"phone\": \"+993XXXXXXXX\", \"pass\": \"<message>\" }\n```"
          },
          "response": [
            {
              "name": "200 – Message sent (with +993 prefix)",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"message\": \"Message sent\",\n  \"phone\": \"+99361123456\",\n  \"pass\": \"Your custom message here\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"+99361123456\",\n  \"message\": \"Your custom message here\"\n}"
                },
                "url": { "raw": "{{base_url}}/send-sms" }
              }
            },
            {
              "name": "200 – Message sent (without prefix)",
              "status": "OK",
              "code": 200,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"success\": true,\n  \"message\": \"Message sent\",\n  \"phone\": \"+99361123456\",\n  \"pass\": \"Your custom message here\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"61123456\",\n  \"message\": \"Your custom message here\"\n}"
                },
                "url": { "raw": "{{base_url}}/send-sms" }
              }
            },
            {
              "name": "400 – Invalid phone",
              "status": "Bad Request",
              "code": 400,
              "header": [{ "key": "Content-Type", "value": "application/json" }],
              "body": "{\n  \"message\": \"Bad request\"\n}",
              "originalRequest": {
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"phone\": \"12345678\",\n  \"message\": \"test\"\n}"
                },
                "url": { "raw": "{{base_url}}/send-sms" }
              }
            }
          ]
        }
      ]
    }
  ]
}
